---
title: "Untitled"
author: "Esther Helga"
date: "2025-05-18"
output: html_document
---

```{r}

eigenvalues_new <- read.table("gwas_1196_pca_30pcs.eigenval", header = FALSE)$V1
variance_explained_new <- eigenvalues_new / sum(eigenvalues_new) * 100 #this gives us the porpotional variance in relation to the 30 PCs calculated and not the total
pc_numbers_new <- 1:length(eigenvalues_new)
scree_data_new <- data.frame(PC = pc_numbers_new, VarianceExplained = variance_explained_new)

library(ggplot2)
ggplot(scree_data_new, aes(x = PC, y = VarianceExplained)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(title = "Scree Plot for 1196 Individuals (Up to 30 PCs)",
       x = "Principal Component", y = "Porportional Percentage of Variance Explained (30 PCs)") +
  scale_x_continuous(breaks = pc_numbers_new) + theme_minimal()

```

